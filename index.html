<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>App de Pedidos - DOG√ÉO PRE√Å</title>
    
    <!-- Fontes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- √çcones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        /* --- VARIAVEIS & TEMAS --- */
        :root {
            /* Cores da Marca */
            --primary: #ff9f1c;
            --primary-rgb: 255, 159, 28;
            --primary-dark: #e08b15;
            --whatsapp: #25D366;
            --danger: #ff4444;
            --ai-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --info-bg: rgba(59, 130, 246, 0.15);
            --info-text: #60a5fa;
            
            /* Tema Escuro (Padr√£o) */
            --bg-body: #0f0f0f;
            --bg-card: #1a1a1a;
            --bg-element: #252525;
            --bg-header: rgba(15, 15, 15, 0.85);
            --text-main: #ffffff;
            --text-muted: #a0a0a0;
            --border-color: #333;
            --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
            --input-bg: #1a1a1a;
            --glass-border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Tema Claro */
        [data-theme="light"] {
            --bg-body: #f0f2f5;
            --bg-card: #ffffff;
            --bg-element: #e4e6eb;
            --bg-header: rgba(255, 255, 255, 0.85);
            --text-main: #1c1e21;
            --text-muted: #65676b;
            --border-color: #e4e6eb;
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            --input-bg: #ffffff;
            --glass-border: 1px solid rgba(0, 0, 0, 0.05);
            --info-text: #2563eb;
        }

        @media (prefers-color-scheme: light) {
            :root:not([data-theme="dark"]) {
                --bg-body: #f0f2f5;
                --bg-card: #ffffff;
                --bg-element: #e4e6eb;
                --bg-header: rgba(255, 255, 255, 0.85);
                --text-main: #1c1e21;
                --text-muted: #65676b;
                --border-color: #e4e6eb;
                --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
                --input-bg: #ffffff;
                --glass-border: 1px solid rgba(0, 0, 0, 0.05);
                --info-text: #2563eb;
            }
        }

        * { margin: 0; padding: 0; box-sizing: border-box; scroll-behavior: smooth; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            line-height: 1.6;
            padding-bottom: 100px;
            transition: background-color 0.3s, color 0.3s;
        }

        /* CLASSE PARA TRAVAR ROLAGEM */
        body.no-scroll {
            overflow: hidden;
            height: 100vh;
        }

        h1, h2, h3, .brand-font {
            font-family: 'Bebas Neue', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* --- ANIMA√á√ïES --- */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 159, 28, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 159, 28, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 159, 28, 0); }
        }

        /* --- UTILITARIOS --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 15px; } /* Padding reduzido */
        .btn { cursor: pointer; border: none; outline: none; transition: 0.2s; font-weight: 700; border-radius: 12px; display: inline-flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-primary { background-color: var(--primary); color: #000; padding: 12px 25px; }
        .btn-primary:hover { background-color: var(--primary-dark); transform: translateY(-2px); }
        .hidden { display: none !important; }
        
        /* --- HEADER COMPACTO --- */
        header {
            background-color: var(--bg-header);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: var(--glass-border);
            padding: 10px 0; /* Padding reduzido */
            transition: background-color 0.3s, border-color 0.3s;
        }
        .nav-flex { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 24px; color: var(--primary); text-shadow: 0 2px 10px rgba(255, 159, 28, 0.3); } /* Fonte logo reduzida */
        
        .header-actions { display: flex; gap: 10px; }
        .icon-btn { 
            background: var(--bg-element); 
            color: var(--text-main); 
            border: none; 
            width: 36px; height: 36px; /* Bot√£o menor */
            border-radius: 50%; 
            cursor: pointer; 
            display: flex; align-items: center; justify-content: center; 
            transition: 0.3s; 
        }
        .icon-btn:hover { background: var(--primary); color: #000; }

        /* --- BARRA DE BUSCA COMPACTA --- */
        .search-container {
            margin-top: 15px;
            margin-bottom: 10px;
            display: flex;
            gap: 10px;
        }
        .search-box {
            width: 100%;
            background-color: var(--bg-element);
            border: 1px solid transparent; /* Borda mais fina */
            border-radius: 12px;
            padding: 10px 15px; /* Padding reduzido */
            color: var(--text-main);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .search-box:focus-within {
            border-color: var(--primary);
            background-color: var(--bg-card);
            box-shadow: 0 0 0 2px rgba(255, 159, 28, 0.1);
        }
        .search-input {
            background: transparent;
            border: none;
            color: var(--text-main);
            width: 100%;
            font-size: 14px;
            outline: none;
            font-family: inherit;
        }
        .search-icon { color: var(--text-muted); font-size: 14px; }

        /* Aviso de busca */
        .search-helper {
            margin-top: 8px;
            background-color: var(--info-bg);
            color: var(--info-text);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid var(--info-text);
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* Bot√£o M√°gico AI */
        .ai-btn {
            background: var(--ai-gradient);
            color: #fff;
            border: none;
            border-radius: 12px;
            width: 44px; /* Menor */
            height: 44px; /* Menor */
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(118, 75, 162, 0.4);
            transition: all 0.3s;
            font-size: 18px;
        }
        .ai-btn:hover { transform: scale(1.05); box-shadow: 0 6px 20px rgba(118, 75, 162, 0.6); }
        .ai-btn:active { transform: scale(0.95); }

        /* --- CATEGORIAS (ATUALIZADO PARA EXIBIR TUDO) --- */
        .category-nav {
            position: sticky;
            top: 60px;
            background-color: var(--bg-body);
            z-index: 90;
            padding: 10px 0;
            /* Alterado para n√£o rolar lateralmente */
            overflow-x: visible; 
            white-space: normal;
            transition: background-color 0.3s;
            border-bottom: 1px solid var(--border-color);
        }
        .category-list { 
            display: flex; 
            flex-wrap: wrap; /* Permite quebra de linha */
            justify-content: center; /* Centraliza os itens */
            gap: 8px; 
            padding: 5px 5px; 
            list-style: none; 
        }
        .cat-btn {
            background: var(--bg-element); 
            border: 1px solid transparent; 
            color: var(--text-muted);
            padding: 8px 16px;
            border-radius: 20px; 
            font-size: 13px; 
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
            display: flex; /* Para alinhar √≠cone e texto */
            align-items: center;
            gap: 6px;
        }
        .cat-btn:hover { color: var(--text-main); background: var(--bg-card); }
        .cat-btn.active { background: var(--primary); color: #000; box-shadow: 0 2px 10px rgba(255, 159, 28, 0.3); transform: scale(1.02); }

        /* --- GRID DE PRODUTOS COMPACTA --- */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); /* Cart√µes mais estreitos */
            gap: 12px; /* Gap reduzido */
            margin-top: 15px;
            margin-bottom: 30px;
        }

        .menu-item {
            background-color: var(--bg-card);
            border-radius: 12px; /* Raio menor */
            border: 1px solid var(--border-color);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            animation: fadeInUp 0.5s ease-out forwards;
            opacity: 0;
        }
        /* Stagger animation */
        .menu-item:nth-child(1) { animation-delay: 0.05s; }
        .menu-item:nth-child(2) { animation-delay: 0.1s; }
        .menu-item:nth-child(3) { animation-delay: 0.15s; }
        .menu-item:nth-child(n+4) { animation-delay: 0.2s; }

        .menu-item:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 8px 20px rgba(0,0,0,0.1); 
            border-color: var(--primary);
        }

        .menu-item::before {
            content: '';
            position: absolute;
            left: 0; top: 0; bottom: 0;
            width: 3px; /* Faixa mais fina */
            background: var(--primary);
            opacity: 0.5;
        }

        .item-content { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; } /* Padding reduzido */
        .item-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 6px; }
        .item-title { font-weight: 700; font-size: 16px; color: var(--text-main); line-height: 1.2; }
        .item-price { color: var(--primary); font-weight: 700; font-size: 16px; white-space: nowrap; margin-left: 8px; }
        .item-desc { font-size: 12px; color: var(--text-muted); margin-bottom: 12px; flex-grow: 1; line-height: 1.4; }
        
        .category-separator {
            margin-top: 25px;
            margin-bottom: 10px;
            font-size: 22px; /* T√≠tulo menor */
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .category-separator::after {
            content: '';
            flex-grow: 1;
            height: 1px;
            background: var(--border-color);
        }

        /* Bot√µes de A√ß√£o Compactos */
        .btn-container { margin-top: auto; height: 36px; } /* Altura reduzida */

        .add-btn {
            width: 100%; height: 100%; background: var(--bg-element); color: var(--text-main); 
            border-radius: 8px; font-weight: 600; border: none;
            display: flex; align-items: center; justify-content: center; gap: 6px;
            cursor: pointer; transition: 0.2s; font-size: 13px;
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        .add-btn:hover { background: var(--primary); color: #000; }

        /* Bot√µes de Quantidade no Grid */
        .qty-selector {
            display: flex; align-items: center; justify-content: space-between;
            background-color: var(--bg-element); border-radius: 8px;
            width: 100%; height: 100%; padding: 0; color: var(--text-main);
            border: 1px solid var(--primary);
        }
        .qty-selector button {
            width: 36px; height: 100%; background: transparent; color: var(--text-main);
            border: none; font-size: 14px; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
        }
        .qty-selector button:active { transform: scale(0.9); background-color: rgba(0,0,0,0.1); }
        .qty-selector button:hover { color: var(--primary); }
        .qty-selector span { color: var(--primary); font-weight: 700; font-size: 15px; }

        /* --- CARRINHO FLUTUANTE --- */
        .floating-cart {
            position: fixed; bottom: 20px; right: 15px; left: 15px;
            background-color: var(--primary); color: #000;
            padding: 14px 20px; border-radius: 50px;
            display: flex; justify-content: space-between; align-items: center;
            font-weight: 700; font-size: 16px;
            box-shadow: 0 8px 20px rgba(255, 159, 28, 0.4);
            cursor: pointer; z-index: 1000;
            transition: all 0.3s;
            animation: popUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .floating-cart:active { transform: scale(0.95); }
        .cart-count { background: #000; color: var(--primary); padding: 2px 8px; border-radius: 20px; font-size: 12px; margin-left: 8px; }
        .hidden { display: none !important; }

        @keyframes popUp { from { transform: translateY(100px); } to { transform: translateY(0); } }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); 
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: flex; justify-content: center; align-items: flex-end;
            opacity: 0; pointer-events: none; transition: 0.3s;
        }
        .modal-overlay.open { opacity: 1; pointer-events: all; }
        
        .modal-content {
            background: var(--bg-card);
            width: 100%; max-width: 600px;
            height: 90vh;
            border-radius: 20px 20px 0 0;
            padding: 20px;
            display: flex; flex-direction: column;
            transform: translateY(100%); transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
            color: var(--text-main);
            box-shadow: 0 -10px 40px rgba(0,0,0,0.3);
        }
        .modal-overlay.open .modal-content { transform: translateY(0); }

        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid var(--border-color); }
        .close-modal { background: var(--bg-element); border: none; color: var(--text-main); width: 32px; height: 32px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s; font-size: 18px; }
        .close-modal:hover { background: var(--danger); color: white; }

        /* --- CHECKOUT FORM & CART ITEMS --- */
        .cart-items { margin-bottom: 20px; }
        .cart-item-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; background: var(--bg-element); padding: 12px; border-radius: 10px; border: 1px solid var(--border-color); }
        .cart-item-info h4 { font-size: 15px; color: var(--text-main); margin-bottom: 2px; }
        .cart-item-info span { font-size: 13px; color: var(--primary); font-weight: 700; }
        
        /* --- BOT√ïES DE QUANTIDADE DO CARRINHO --- */
        .qty-controls { display: flex; align-items: center; gap: 12px; }
        .qty-btn { 
            background: var(--bg-body); 
            color: var(--text-main); 
            width: 36px; 
            height: 36px; 
            border-radius: 50%; 
            border: 1px solid var(--border-color); 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            font-size: 14px; 
            transition: 0.2s;
        }
        .qty-btn:active { transform: scale(0.9); background-color: var(--bg-element); }
        
        .form-group { margin-bottom: 15px; }
        .form-label { display: block; margin-bottom: 5px; font-size: 13px; font-weight: 600; color: var(--text-muted); }
        .form-input, .form-select { 
            width: 100%; padding: 12px; background: var(--input-bg); border: 1px solid var(--border-color); 
            color: var(--text-main); border-radius: 10px; font-family: inherit; font-size: 15px;
            transition: 0.3s;
        }
        .form-input:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(255, 159, 28, 0.2); }

        .radio-group { display: flex; gap: 10px; flex-wrap: wrap; }
        .radio-option { flex: 1; position: relative; min-width: 90px; }
        .radio-option input { display: none; }
        .radio-option label {
            display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px;
            padding: 12px; text-align: center; background: var(--bg-element); 
            border: 2px solid transparent; border-radius: 10px; cursor: pointer; 
            font-size: 13px; font-weight: 600; transition: 0.2s; color: var(--text-muted);
        }
        .radio-option label i { font-size: 18px; }
        .radio-option input:checked + label { background: rgba(255, 159, 28, 0.15); color: var(--primary); border-color: var(--primary); }

        .geo-btn {
            background: #25D366; color: #fff; width: 100%; margin-top: 10px;
            border: none; padding: 12px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; font-weight: 600; font-size: 14px;
        }
        .geo-status { font-size: 11px; color: var(--text-muted); margin-top: 6px; text-align: center; }

        .delivery-fee-notice {
            background-color: rgba(255, 159, 28, 0.1);
            border-left: 3px solid var(--primary); color: var(--text-main);
            padding: 10px; border-radius: 0 6px 6px 0; font-size: 12px; margin-bottom: 15px;
            display: flex; align-items: center; gap: 10px;
        }

        /* Novo estilo para o aviso de tempo */
        .delivery-time-notice {
            background-color: rgba(37, 211, 102, 0.1); /* Tom esverdeado/whatsapp */
            border-left: 3px solid var(--whatsapp); color: var(--text-main);
            padding: 10px; border-radius: 0 6px 6px 0; font-size: 12px; margin-bottom: 15px;
            display: flex; align-items: center; gap: 10px;
        }

        .cart-total { font-size: 22px; color: var(--primary); text-align: right; margin: 20px 0; border-top: 1px dashed var(--border-color); padding-top: 15px; font-weight: 800; }
        
        /* Bot√£o de WhatsApp com Contorno e Sombra Refor√ßados */
        .btn-whatsapp { 
            width: 100%; 
            background: var(--whatsapp); 
            color: #fff; 
            padding: 16px; 
            border-radius: 12px; 
            font-size: 18px; 
            font-weight: 700; 
            border: 2px solid rgba(255,255,255,0.1); /* Contorno sutil */
            box-shadow: 0 6px 20px rgba(37, 211, 102, 0.3); 
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn-whatsapp:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.5); 
        }

        /* Bot√£o "Adicionar mais itens" (Outline Maior) */
        .btn-outline {
            width: 100%;
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--text-main);
            padding: 14px;
            border-radius: 12px;
            font-weight: 700;
            margin-top: 15px;
            margin-bottom: 10px;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 15px;
            cursor: pointer;
        }
        .btn-outline:hover {
            background: rgba(255, 159, 28, 0.1);
            border-color: var(--primary-dark);
        }

        /* --- CHAT IA (ESTILO WHATSAPP/TELEGRAM) --- */
        #chef-bot-modal .modal-content {
            background: var(--bg-body);
            padding: 0;
            height: 85vh;
        }
        #chef-bot-modal .modal-header {
            background: var(--bg-header);
            padding: 15px;
            margin-bottom: 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            background-image: radial-gradient(var(--border-color) 1px, transparent 1px);
            background-size: 20px 20px; /* Pattern sutil */
        }

        .message { 
            padding: 10px 14px; 
            border-radius: 16px; 
            max-width: 85%; 
            font-size: 14px; 
            line-height: 1.4; 
            position: relative;
            animation: fadeInUp 0.3s ease;
        }
        
        .message.bot { 
            background: var(--bg-element); 
            color: var(--text-main); 
            align-self: flex-start; 
            border-bottom-left-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .message.user { 
            background: var(--primary); 
            color: #000; 
            align-self: flex-end; 
            border-bottom-right-radius: 4px;
            font-weight: 500;
            box-shadow: 0 2px 10px rgba(255, 159, 28, 0.3);
        }

        .typing-indicator { 
            font-size: 11px; color: var(--text-muted); font-style: italic; 
            margin-bottom: 10px; padding-left: 20px; display: none;
        }

        /* Quick Replies (Chips) */
        .quick-replies {
            display: flex;
            gap: 8px;
            padding: 10px 15px;
            overflow-x: auto;
            white-space: nowrap;
            background: var(--bg-card);
            border-top: 1px solid var(--border-color);
        }
        
        .reply-chip {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 6px 14px;
            border-radius: 18px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
        }
        .reply-chip:hover { background: var(--primary); color: #000; }

        .input-area { 
            display: flex; gap: 10px; padding: 12px; 
            background: var(--bg-card); border-top: 1px solid var(--border-color); 
        }
        .chat-input { flex: 1; border-radius: 25px !important; }
        .chat-btn { 
            background: var(--ai-gradient); color: white; border: none; 
            width: 44px; height: 44px; border-radius: 50%; cursor: pointer; 
            display: flex; align-items: center; justify-content: center;
            transition: transform 0.2s;
        }
        .chat-btn:active { transform: scale(0.9); }

    </style>
</head>
<body>

    <!-- Header -->
    <header>
        <div class="container nav-flex">
            <div class="logo brand-font">DOG√ÉO PRE√Å</div>
            <div class="header-actions">
                <!-- Bot√£o de Tema -->
                <button class="icon-btn" onclick="toggleTheme()" title="Alternar Tema">
                    <i class="fas fa-sun" id="theme-icon"></i>
                </button>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Barra de Busca + Bot√£o M√°gico -->
        <div class="search-container">
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="search-input" placeholder="Pesquisar lanche..." oninput="searchProducts(this.value)">
            </div>
            <button class="ai-btn" onclick="toggleChefBot()" title="Falar com Chef Dog√£o">
                <i class="fas fa-comment-dots"></i>
            </button>
        </div>
        <!-- Aviso de Busca (Din√¢mico - REINTRODUZIDO) -->
        <div id="search-helper" class="search-helper hidden">
            <i class="fas fa-info-circle"></i>
            <span>Marcas e sabores ser√£o combinados no WhatsApp ap√≥s o pedido.</span>
        </div>
    </div>

    <!-- Navega√ß√£o Categorias -->
    <nav class="category-nav">
        <ul class="category-list" id="category-list">
            <!-- Preenchido via JS -->
        </ul>
    </nav>

    <!-- Conte√∫do Principal -->
    <div class="container">
        <div id="menu-container">
            <!-- Preenchido via JS -->
        </div>
    </div>

    <!-- Bot√£o Flutuante do Carrinho -->
    <div id="floating-cart" class="floating-cart hidden" onclick="toggleCart()">
        <span><i class="fas fa-shopping-bag"></i> Sacola <span id="cart-count" class="cart-count">0</span></span>
        <span id="cart-total-float">R$ 0,00</span>
    </div>

    <!-- Modal de Checkout -->
    <div class="modal-overlay" id="cart-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="brand-font">Finalizar Pedido</h2>
                <button class="close-modal" onclick="toggleCart()"><i class="fas fa-times"></i></button>
            </div>
            <div id="cart-items" class="cart-items"><p style="text-align: center; color: var(--text-muted); margin-top: 20px;">Sua sacola est√° vazia üòî</p></div>
            
            <!-- Bot√£o para adicionar mais itens -->
            <button id="btn-add-more" class="btn-outline" onclick="toggleCart()" style="display: none;">
                <i class="fas fa-plus"></i> Adicionar mais itens
            </button>

            <div class="cart-total brand-font" id="modal-total">Total: R$ 0,00</div>
            
            <div id="checkout-form" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Seu Nome</label>
                    <input type="text" id="customer-name" class="form-input" placeholder="Como podemos te chamar?">
                </div>
                <div class="form-group">
                    <label class="form-label">Tipo de Entrega</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="orderType" id="type-delivery" value="Entrega" onchange="toggleAddressField(true)">
                            <label for="type-delivery"><i class="fas fa-motorcycle"></i> Entrega</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="orderType" id="type-pickup" value="Retirada" onchange="toggleAddressField(false)">
                            <label for="type-pickup"><i class="fas fa-box"></i> Retirada</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="orderType" id="type-eatin" value="Mesa" onchange="toggleAddressField(false)">
                            <label for="type-eatin"><i class="fas fa-utensils"></i> Mesa</label>
                        </div>
                    </div>
                </div>
                
                <div id="address-section" class="form-group hidden">
                    <div class="delivery-fee-notice">
                        <i class="fas fa-info-circle" style="font-size: 20px;"></i>
                        <span>A taxa de entrega ser√° calculada no WhatsApp.</span>
                    </div>
                    
                    <!-- Novo Informe de Tempo de Entrega -->
                    <div class="delivery-time-notice">
                        <i class="fas fa-clock" style="font-size: 20px; color: var(--whatsapp);"></i>
                        <span><strong>Previs√£o: 30 a 60 min.</strong><br>Tentaremos entregar o quanto antes! üöÄ</span>
                    </div>

                    <label class="form-label">Endere√ßo</label>
                    <button type="button" class="geo-btn" onclick="getLocation()">
                        <i class="fas fa-map-marker-alt"></i> Usar Localiza√ß√£o Atual
                    </button>
                    <div id="geo-status" class="geo-status"></div>
                    <textarea id="address-text" class="form-input" rows="2" placeholder="Rua, N√∫mero, Bairro, Refer√™ncia..." style="margin-top: 10px;"></textarea>
                    <input type="hidden" id="maps-link">
                </div>

                <!-- Novo Campo de Observa√ß√µes -->
                <div class="form-group">
                    <label class="form-label">Observa√ß√µes</label>
                    <textarea id="order-observations" class="form-input" rows="2" placeholder="Ex: Sem cebola, capricha no molho..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Pagamento</label>
                    <select id="payment-method" class="form-select" onchange="togglePaymentInfo(this.value)">
                        <option value="PIX">PIX (Agilidade)</option>
                        <option value="Cart√£o de Cr√©dito">Cart√£o de Cr√©dito</option>
                        <option value="Cart√£o de D√©bito">Cart√£o de D√©bito</option>
                        <option value="Dinheiro">Dinheiro</option>
                    </select>
                </div>

                <!-- Aviso PIX -->
                <div id="pix-section" class="form-group">
                    <div class="delivery-fee-notice" style="background-color: rgba(37, 211, 102, 0.1); border-color: var(--whatsapp); color: var(--text-main);">
                        <i class="fas fa-qrcode" style="font-size: 24px; color: var(--whatsapp);"></i>
                        <span style="font-size: 12px; line-height: 1.4;">A chave PIX ser√° enviada no WhatsApp ap√≥s confer√™ncia do valor. <br><strong>O envio/retirada depende do comprovante.</strong></span>
                    </div>
                </div>

                <!-- Aviso Taxa Cart√£o (NOVO) -->
                <div id="card-fee-section" class="form-group hidden">
                    <div class="delivery-fee-notice" style="background-color: rgba(59, 130, 246, 0.1); border-color: #60a5fa; color: var(--text-main);">
                        <i class="fas fa-credit-card" style="font-size: 24px; color: #60a5fa;"></i>
                        <span style="font-size: 12px; line-height: 1.4;">‚ÑπÔ∏è <strong>Tarifa de Cart√£o:</strong> H√° uma pequena tarifa de processamento para pagamentos com cart√£o. O valor ser√° acrescido ao total ap√≥s o envio do pedido pelo WhatsApp.</span>
                    </div>
                </div>

                <!-- Campo de Troco Din√¢mico -->
                <div id="change-section" class="form-group hidden">
                    <label class="form-label">Troco para quanto?</label>
                    <input type="tel" id="change-amount" class="form-input" placeholder="Ex: 50" oninput="this.value = this.value.replace(/[^0-9.,]/g, '')">
                </div>

                <button class="btn btn-whatsapp" onclick="finalizeOrder()">
                    <i class="fab fa-whatsapp"></i> ENVIAR PEDIDO NO WHATSAPP
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Chef Bot IA Moderno -->
    <div class="modal-overlay" id="chef-bot-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--ai-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px;">ü§ñ</div>
                    <div>
                        <h2 class="brand-font" style="margin: 0; font-size: 20px;">Chef Dog√£o</h2>
                        <span style="font-size: 12px; color: #25D366; display: flex; align-items: center; gap: 4px;"><i class="fas fa-circle" style="font-size: 8px;"></i> Online</span>
                    </div>
                </div>
                <button class="close-modal" onclick="toggleChefBot()"><i class="fas fa-times"></i></button>
            </div>
            
            <div class="chat-container">
                <div class="chat-messages" id="chat-messages">
                    <!-- Mensagens iniciais injetadas via JS -->
                </div>
                <div class="typing-indicator" id="typing-indicator">Chef Dog√£o est√° digitando...</div>
                
                <!-- Bot√µes de Resposta R√°pida -->
                <div class="quick-replies" id="quick-replies">
                    <!-- Preenchido via JS -->
                </div>

                <div class="input-area">
                    <input type="text" id="chat-input" class="form-input chat-input" placeholder="Digite aqui..." onkeypress="handleChatKey(event)">
                    <button class="chat-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DADOS DO CARD√ÅPIO ---
        const menuData = [
            { id: 1, name: "Queijo e Ovos", price: 10.00, category: "sanduiches", desc: "P√£o, queijo e ovos." },
            { id: 2, name: "Hamb√∫rguer", price: 10.00, category: "sanduiches", desc: "P√£o, carne de hamb√∫rguer e salada." },
            { id: 3, name: "Misto Quente", price: 10.00, category: "sanduiches", desc: "P√£o, queijo e presunto." },
            { id: 4, name: "X-Burguer", price: 12.00, category: "sanduiches", desc: "P√£o, carne de hamb√∫rguer e queijo." },
            { id: 5, name: "Frango Simples", price: 12.00, category: "sanduiches", desc: "P√£o, frango, queijo, salada e milho verde." },
            { id: 6, name: "Calabresa Simples", price: 12.00, category: "sanduiches", desc: "P√£o, calabresa, queijo e salada." },
            { id: 7, name: "Americano", price: 12.00, category: "sanduiches", desc: "P√£o, queijo, presunto, ovos e salada." },
            { id: 8, name: "X-Salada", price: 12.00, category: "sanduiches", desc: "P√£o, carne de hamb√∫rguer, queijo e salada." },
            { id: 9, name: "Baur√∫", price: 14.00, category: "sanduiches", desc: "P√£o, carne, queijo, presunto e salada." },
            { id: 10, name: "X-Egg", price: 14.00, category: "sanduiches", desc: "P√£o, carne, queijo, ovos e salada." },
            { id: 11, name: "X-Calabresa", price: 14.00, category: "sanduiches", desc: "P√£o, carne, queijo, calabresa e salada." },
            { id: 12, name: "X-Frango", price: 14.00, category: "sanduiches", desc: "P√£o, carne, queijo, frango e salada." },
            { id: 13, name: "X-Bacon", price: 15.00, category: "sanduiches", desc: "P√£o, carne, queijo, bacon e salada." },
            { id: 14, name: "X-Frango Bacon", price: 15.00, category: "sanduiches", desc: "P√£o, carne, queijo, frango, bacon e salada." },
            { id: 15, name: "X-Tudo", price: 18.00, category: "especiais", desc: "P√£o, carne, queijo, frango, presunto, ovos, bacon e salada." },
            { id: 16, name: "Sandubob", price: 16.00, category: "especiais", desc: "P√£o √°rabe, 2 carnes, queijo, ovos e salada." },
            { id: 17, name: "Dog√£o (P√£o √Årabe)", price: 18.00, category: "especiais", desc: "P√£o √°rabe, carne caseira, queijo, frango, bacon, calabresa, salada." },
            { id: 18, name: "Lanch√£o (P√£o √Årabe)", price: 18.00, category: "especiais", desc: "P√£o √°rabe, carne, queijo, frango, ovos, bacon, salada." },
            { id: 19, name: "Hot-Dog Simples", price: 12.00, category: "hotdogs", desc: "P√£o, molho carne, salsicha, salada, batata, milho." },
            { id: 20, name: "Hot-Scooby", price: 14.00, category: "hotdogs", desc: "P√£o, molho carne, 2 salsichas, salada, batata, milho, queijo." },
            { id: 21, name: "Pastel Misto (P)", price: 10.00, category: "pasteis", desc: "Tamanho Pequeno." },
            { id: 22, name: "Pastel Misto (G)", price: 12.00, category: "pasteis", desc: "Tamanho Grande." },
            { id: 23, name: "Pastel Queijo (P)", price: 10.00, category: "pasteis", desc: "Tamanho Pequeno." },
            { id: 24, name: "Pastel Queijo (G)", price: 12.00, category: "pasteis", desc: "Tamanho Grande." },
            { id: 25, name: "Pastel Carne (P)", price: 12.00, category: "pasteis", desc: "Tamanho Pequeno." },
            { id: 26, name: "Pastel Carne (G)", price: 14.00, category: "pasteis", desc: "Tamanho Grande." },
            { id: 27, name: "Pastel Frango/Queijo (P)", price: 12.00, category: "pasteis", desc: "Tamanho Pequeno." },
            { id: 28, name: "Pastel Frango/Queijo (G)", price: 14.00, category: "pasteis", desc: "Tamanho Grande." },
            { id: 29, name: "Batata Frita (P)", price: 15.00, category: "bebidas", desc: "Por√ß√£o Pequena." },
            { id: 30, name: "Batata Frita (G)", price: 20.00, category: "bebidas", desc: "Por√ß√£o Grande." },
            { id: 31, name: "Batata Recheada", price: 35.00, category: "bebidas", desc: "Batata frita, bacon e calabresa." },
            { id: 32, name: "Sucos Naturais", price: 0.00, category: "bebidas", desc: "Valores a consultar." },
            { id: 33, name: "Refrigerante Lata", price: 0.00, category: "bebidas", desc: "350ml. Sabor a combinar.", keywords: ["coca", "cola", "fanta", "guarana", "guaran√°", "pepsi", "sprite", "sukita", "kuat", "soda", "antarctica"] },
            { id: 34, name: "Refrigerante 1 Litro", price: 0.00, category: "bebidas", desc: "Sabor a combinar.", keywords: ["coca", "cola", "fanta", "guarana", "guaran√°", "pepsi", "sprite", "sukita", "kuat", "soda", "antarctica"] },
            { id: 35, name: "Refrigerante 1.5 Litros", price: 0.00, category: "bebidas", desc: "Sabor a combinar.", keywords: ["coca", "cola", "fanta", "guarana", "guaran√°", "pepsi", "sprite", "sukita", "kuat", "soda", "antarctica"] },
            { id: 36, name: "Refrigerante 2 Litros", price: 0.00, category: "bebidas", desc: "Sabor a combinar.", keywords: ["coca", "cola", "fanta", "guarana", "guaran√°", "pepsi", "sprite", "sukita", "kuat", "soda", "antarctica"] }
        ];

        // --- C√ìDIGO ATUALIZADO PARA CATEGORIAS COM √çCONES E SEM ROLAGEM ---
        const categories = [
            { id: 'sanduiches', label: 'Sandu√≠ches', icon: 'fas fa-burger' },
            { id: 'especiais', label: 'Especiais', icon: 'fas fa-star' },
            { id: 'hotdogs', label: 'Hot Dogs', icon: 'fas fa-hotdog' },
            { id: 'pasteis', label: 'Past√©is', icon: 'fas fa-cheese' },
            { id: 'bebidas', label: 'Bebidas', icon: 'fas fa-glass-water' } // "Acompanhamentos" abreviado para caber melhor
        ];

        let cart = [];

        window.onload = () => {
            // Tema
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
                updateThemeIcon(savedTheme);
            } else {
                const prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;
                if (prefersLight) {
                    document.documentElement.setAttribute('data-theme', 'light');
                    updateThemeIcon('light');
                }
            }

            renderCategories();
            renderMenu();
            initChat(); // Inicia o chat
        };

        /* --- TEMA --- */
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const icon = document.getElementById('theme-icon');
            if (theme === 'light') {
                icon.classList.remove('fa-sun'); icon.classList.add('fa-moon');
            } else {
                icon.classList.remove('fa-moon'); icon.classList.add('fa-sun');
            }
        }

        /* --- UI RENDER (CATEGORIAS ATUALIZADAS) --- */
        function renderCategories() {
            const list = document.getElementById('category-list');
            // Adicionei a classe fa-fw para √≠cones com largura fixa e melhor alinhamento
            list.innerHTML = `<li><button class="cat-btn active" onclick="filterMenu('all', this)"><i class="fas fa-border-all"></i> Todos</button></li>` + 
                categories.map(c => `<li><button class="cat-btn" onclick="filterMenu('${c.id}', this)"><i class="${c.icon}"></i> ${c.label}</button></li>`).join('');
        }

        function getButtonHtml(id) {
            const itemInCart = cart.find(i => i.id === id);
            if (itemInCart) {
                return `<div class="qty-selector"><button onclick="updateQty(${id}, -1)"><i class="fas fa-minus"></i></button><span>${itemInCart.qty}</span><button onclick="updateQty(${id}, 1)"><i class="fas fa-plus"></i></button></div>`;
            } else {
                return `<button class="add-btn" onclick="addToCart(${id})">ADICIONAR <i class="fas fa-plus"></i></button>`;
            }
        }

        function createItemCard(item) {
             const priceDisplay = item.price > 0 ? `R$ ${item.price.toFixed(2).replace('.',',')}` : "Consultar";
             return `
                <div class="menu-item">
                    <div class="item-content">
                        <div class="item-header">
                            <span class="item-title">${item.name}</span>
                            <span class="item-price">${priceDisplay}</span>
                        </div>
                        <p class="item-desc">${item.desc}</p>
                        <div class="btn-container" id="btn-container-${item.id}">
                            ${getButtonHtml(item.id)}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderMenu(filter = 'all') {
            const container = document.getElementById('menu-container');
            container.innerHTML = ''; 

            if (filter === 'all') {
                categories.forEach(cat => {
                    const items = menuData.filter(i => i.category === cat.id);
                    if (items.length > 0) {
                        const title = document.createElement('h3');
                        title.className = 'brand-font category-separator';
                        title.innerText = cat.label;
                        container.appendChild(title);

                        const grid = document.createElement('div');
                        grid.className = 'menu-grid';
                        grid.innerHTML = items.map(item => createItemCard(item)).join('');
                        container.appendChild(grid);
                    }
                });
            } else {
                const items = menuData.filter(i => i.category === filter);
                const grid = document.createElement('div');
                grid.className = 'menu-grid';
                grid.innerHTML = items.map(item => createItemCard(item)).join('');
                container.appendChild(grid);
            }
        }

        function filterMenu(catId, btnElement) {
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            if (btnElement) btnElement.classList.add('active');
            renderMenu(catId);
        }

        /* --- BUSCA (ATUALIZADA) --- */
        function searchProducts(query) {
            const term = query.toLowerCase().trim();
            const catButtons = document.querySelectorAll('.cat-btn');
            const helper = document.getElementById('search-helper');
            
            // L√≥gica para mostrar o aviso de refrigerante
            const sodaBrands = ["coca", "cola", "fanta", "guarana", "guaran√°", "pepsi", "sprite", "sukita", "kuat", "soda", "antarctica", "refri"];
            const isSodaSearch = sodaBrands.some(brand => term.includes(brand));

            if(isSodaSearch) {
                helper.classList.remove('hidden');
            } else {
                helper.classList.add('hidden');
            }
            
            if (term.length > 0) {
                catButtons.forEach(btn => btn.classList.remove('active'));
                const filtered = menuData.filter(item => {
                    const nameMatch = item.name.toLowerCase().includes(term);
                    const descMatch = item.desc.toLowerCase().includes(term);
                    const keywordMatch = item.keywords ? item.keywords.some(k => k.includes(term)) : false;
                    return nameMatch || descMatch || keywordMatch;
                });
                
                const container = document.getElementById('menu-container');
                if(filtered.length === 0) {
                    container.innerHTML = `<div style="text-align: center; padding: 40px; color: var(--text-muted);"><i class="fas fa-search" style="font-size: 40px; margin-bottom: 10px;"></i><p>Nenhum produto encontrado.</p></div>`;
                } else {
                    container.innerHTML = `<div class="menu-grid" style="margin-top: 20px;">${filtered.map(item => createItemCard(item)).join('')}</div>`;
                }
            } else {
                helper.classList.add('hidden');
                filterMenu('all', document.querySelector('.cat-btn'));
            }
        }

        /* --- CARRINHO --- */
        function addToCart(id) {
            const item = menuData.find(i => i.id === id);
            const existing = cart.find(i => i.id === id);
            if (existing) existing.qty++; else cart.push({ ...item, qty: 1 });
            updateGridButton(id); updateCartUI();
            if (navigator.vibrate) navigator.vibrate(50);
        }

        function updateQty(id, change) {
            const itemIndex = cart.findIndex(i => i.id === id);
            if (itemIndex > -1) {
                cart[itemIndex].qty += change;
                if (cart[itemIndex].qty <= 0) cart.splice(itemIndex, 1);
            }
            updateGridButton(id); updateCartUI();
        }

        function updateGridButton(id) {
            const container = document.getElementById(`btn-container-${id}`);
            if (container) container.innerHTML = getButtonHtml(id);
        }

        function updateCartUI() {
            const totalQty = cart.reduce((acc, item) => acc + item.qty, 0);
            const totalPrice = cart.reduce((acc, item) => acc + (item.price * item.qty), 0);
            
            const floatBtn = document.getElementById('floating-cart');
            document.getElementById('cart-count').innerText = totalQty;
            document.getElementById('cart-total-float').innerText = `R$ ${totalPrice.toFixed(2).replace('.',',')}`;
            
            // Elementos do Modal
            const checkoutForm = document.getElementById('checkout-form');
            const btnAddMore = document.getElementById('btn-add-more');

            if (totalQty > 0) {
                floatBtn.classList.remove('hidden');
                checkoutForm.style.display = 'block';
                btnAddMore.style.display = 'flex'; // Mostra o bot√£o
            } else {
                floatBtn.classList.add('hidden');
                checkoutForm.style.display = 'none';
                btnAddMore.style.display = 'none'; // Esconde o bot√£o
            }

            const list = document.getElementById('cart-items');
            if (cart.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: var(--text-muted); margin-top: 20px;">Sua sacola est√° vazia üòî</p>';
            } else {
                list.innerHTML = cart.map(item => {
                    const itemTotal = item.price > 0 ? `R$ ${(item.price * item.qty).toFixed(2).replace('.',',')}` : "A Consultar";
                    return `<div class="cart-item-row"><div class="cart-item-info"><h4>${item.name}</h4><span>${itemTotal}</span></div><div class="qty-controls"><button class="qty-btn" onclick="updateQty(${item.id}, -1)">-</button><span style="color: var(--text-main); font-weight: bold;">${item.qty}</span><button class="qty-btn" onclick="updateQty(${item.id}, 1)">+</button></div></div>`
                }).join('');
            }
            document.getElementById('modal-total').innerText = `Total: R$ ${totalPrice.toFixed(2).replace('.',',')}`;
        }

        function toggleCart() {
            const modal = document.getElementById('cart-modal');
            modal.classList.toggle('open');
            if (modal.classList.contains('open')) {
                document.body.classList.add('no-scroll');
            } else {
                document.body.classList.remove('no-scroll');
            }
        }

        function toggleChefBot() {
            const modal = document.getElementById('chef-bot-modal');
            modal.classList.toggle('open');
            if (modal.classList.contains('open')) {
                document.body.classList.add('no-scroll');
            } else {
                document.body.classList.remove('no-scroll');
            }
        }

        function toggleAddressField(show) {
            const el = document.getElementById('address-section');
            if (show) el.classList.remove('hidden'); else el.classList.add('hidden');
        }

        /* Nova fun√ß√£o para controlar campos de pagamento */
        function togglePaymentInfo(value) {
            const changeSection = document.getElementById('change-section');
            const pixSection = document.getElementById('pix-section');
            const cardSection = document.getElementById('card-fee-section');
            
            // Esconde tudo primeiro
            changeSection.classList.add('hidden');
            pixSection.classList.add('hidden');
            cardSection.classList.add('hidden');

            // Mostra o relevante
            if (value === 'Dinheiro') {
                changeSection.classList.remove('hidden');
            } else if (value === 'PIX') {
                pixSection.classList.remove('hidden');
            } else if (value === 'Cart√£o de Cr√©dito' || value === 'Cart√£o de D√©bito') {
                cardSection.classList.remove('hidden');
            }
        }

        function getLocation() {
            const status = document.getElementById('geo-status');
            const mapsInput = document.getElementById('maps-link');
            if (!navigator.geolocation) { status.innerText = "Geolocaliza√ß√£o n√£o suportada."; return; }
            status.innerText = "Buscando...";
            const options = { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 };
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const link = `https://www.google.com/maps/search/?api=1&query=${lat},${lng}`;
                    mapsInput.value = link;
                    status.innerHTML = `<span class="geo-success"><i class="fas fa-check-circle"></i> Localiza√ß√£o salva!</span>`;
                },
                (error) => {
                    status.innerText = "Erro no GPS. Digite o endere√ßo abaixo.";
                    document.getElementById('address-text').focus();
                }, options
            );
        }

        function finalizeOrder() {
            const name = document.getElementById('customer-name').value;
            const typeRadio = document.querySelector('input[name="orderType"]:checked');
            const payment = document.getElementById('payment-method').value;
            const observations = document.getElementById('order-observations').value; // Captura observa√ß√£o
            const changeAmount = document.getElementById('change-amount').value;
            
            if (!name) return alert("Por favor, digite seu nome.");
            if (!typeRadio) return alert("Escolha o tipo de entrega.");
            
            const type = typeRadio.value;
            let addressMsg = "";
            if (type === 'Entrega') {
                const mapsLink = document.getElementById('maps-link').value;
                const addressText = document.getElementById('address-text').value;
                if (!mapsLink && !addressText) return alert("Para entrega, precisamos do endere√ßo.");
                if (mapsLink) addressMsg += `\nüìç *GPS:* ${mapsLink}`;
                if (addressText) addressMsg += `\nüè† *Endere√ßo:* ${addressText}`;
            }

            let msg = `*NOVO PEDIDO - DOG√ÉO PRE√Å*\n----------------------------\n`;
            msg += `üë§ *Cliente:* ${name}\n`;
            msg += `üì¶ *Tipo:* ${type}\n`;
            msg += `üí∞ *Pagamento:* ${payment}\n`;

            if (payment === 'Dinheiro' && changeAmount) {
                msg += `üíµ *Troco para:* R$ ${changeAmount}\n`;
            }

            msg += `\n*ITENS:*\n`;
            
            let hasConsultItem = false;
            cart.forEach(item => {
                const priceTxt = item.price > 0 ? `(R$ ${(item.price * item.qty).toFixed(2)})` : "(Consultar)";
                msg += `${item.qty}x ${item.name} ${priceTxt}\n`;
                if(item.price === 0) hasConsultItem = true;
            });
            
            const total = cart.reduce((acc, i) => acc + (i.price * i.qty), 0);
            msg += `\n*TOTAL: R$ ${total.toFixed(2).replace('.',',')}*`;
            
            if(hasConsultItem) msg += `\n‚ö†Ô∏è _Cont√©m itens a consultar valor._`;

            // Adiciona observa√ß√µes √† mensagem se houver
            if (observations && observations.trim() !== "") {
                msg += `\n\nüìù *OBSERVA√á√ïES:*\n${observations}`;
            }

            if (addressMsg) msg += `\n\n*ENTREGA:*${addressMsg}\n‚ö†Ô∏è _Taxa a calcular._`;
            
            const phone = "5588996768158";
            const url = `https://wa.me/${phone}?text=${encodeURIComponent(msg)}`;
            window.open(url, '_blank');
        }

        /* --- CHATBOT ATUALIZADO --- */
        const quickReplies = [
            { text: "ü¶Å Muita Fome!", msg: "fome" },
            { text: "üí∏ Algo Barato", msg: "barato" },
            { text: "ü•ì Bacon √© Vida", msg: "bacon" },
            { text: "ü•§ Estou com Sede", msg: "beber" },
            { text: "üìú Ver Card√°pio", msg: "card√°pio" }
        ];

        function initChat() {
            const container = document.getElementById('chat-messages');
            container.innerHTML = `<div class="message bot">Ol√°! üëã Eu sou o Chef Dog√£o. N√£o sabe o que pedir? Escolha uma op√ß√£o abaixo ou diga o que gosta! üçî</div>`;
            renderQuickReplies();
        }

        function renderQuickReplies() {
            const container = document.getElementById('quick-replies');
            container.innerHTML = quickReplies.map(r => 
                `<button class="reply-chip" onclick="sendQuickReply('${r.msg}')">${r.text}</button>`
            ).join('');
        }

        function sendQuickReply(msg) {
            document.getElementById('chat-input').value = msg;
            sendMessage();
        }

        function handleChatKey(e) { if(e.key === 'Enter') sendMessage(); }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const msg = input.value.trim().toLowerCase();
            const messagesContainer = document.getElementById('chat-messages');

            if (!msg) return;

            // User Msg
            messagesContainer.innerHTML += `<div class="message user">${input.value}</div>`;
            input.value = '';
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // Typing...
            document.getElementById('typing-indicator').style.display = 'block';

            setTimeout(() => {
                let responseText = "";
                
                if (msg.includes('oi') || msg.includes('ola')) {
                    responseText = "E a√≠! Tudo bem? üëã O que vai ser hoje? Um X-Tudo caprichado?";
                } 
                else if (msg.includes('fome') || msg.includes('grande') || msg.includes('gigante')) {
                    const bigItems = menuData.filter(i => i.name.includes('X-Tudo') || i.name.includes('Dog√£o') || i.name.includes('Lanch√£o'));
                    const item = bigItems[Math.floor(Math.random() * bigItems.length)];
                    responseText = `Se a fome √© de le√£o ü¶Å, vai de **${item.name}**! √â gigante e custa R$ ${item.price.toFixed(2).replace('.',',')}.`;
                }
                else if (msg.includes('bacon')) {
                    const baconItems = menuData.filter(i => i.name.toLowerCase().includes('bacon'));
                    const item = baconItems[Math.floor(Math.random() * baconItems.length)];
                    responseText = `ü•ì Bacon crocante? Temos! O **${item.name}** √© perfeito pra voc√™.`;
                }
                else if (msg.includes('frango')) {
                    responseText = `üçó Franguinho top! Recomendo o **X-Frango Bacon** ou o nosso **Pastel de Frango**.`;
                }
                else if (msg.includes('barato') || msg.includes('10')) {
                    responseText = `ü§ë Quer economizar? O **Queijo e Ovos** ou o **Misto Quente** saem por apenas R$ 10,00!`;
                }
                else if (msg.includes('beber') || msg.includes('sede') || msg.includes('refri')) {
                    responseText = "ü•§ Para refrescar, temos Sucos Naturais e Refrigerantes de todos os tamanhos!";
                }
                else if (msg.includes('pastel')) {
                    responseText = "ü•ü Nossos past√©is s√£o fritos na hora! Misto, Queijo, Carne ou Frango. Qual o tamanho da sua vontade?";
                }
                else if (msg.includes('card√°pio') || msg.includes('menu')) {
                    responseText = "üìú O card√°pio est√° logo atr√°s de mim! √â s√≥ fechar aqui e rolar a tela para ver tudo.";
                }
                else {
                    const randomItem = menuData[Math.floor(Math.random() * menuData.length)];
                    responseText = `Hummm... que tal experimentar um **${randomItem.name}**? √â um dos meus favoritos! üòã`;
                }

                messagesContainer.innerHTML += `<div class="message bot">${responseText}</div>`;
                document.getElementById('typing-indicator').style.display = 'none';
                messagesContainer.scrollTop = messagesContainer.scrollHeight;

            }, 800);
        }
    </script>
</body>
</html>
